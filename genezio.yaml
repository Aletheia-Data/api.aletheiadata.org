name: aletheia-data-api
region: us-east-1
yamlVersion: 2

backend:
    functions:
        - entry: index.js
          handler: handler
          name: express
          path: .
          type: httpServer
          # Ensure the build tools are installed before starting the backend service
          environment:
            - key: INSTALL_BUILD_TOOLS
              value: "true"

language:
    name: js
    runtime: nodejs20.x
    path: .

scripts:
    deploy:
        - if [ "$INSTALL_BUILD_TOOLS" = "true" ]; then sudo yum groupinstall "Development Tools" -y; fi
        - npm install

    local:
        - if [ "$INSTALL_BUILD_TOOLS" = "true" ]; then sudo yum groupinstall "Development Tools" -y; fi
        - npm install
